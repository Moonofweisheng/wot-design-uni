var e=Object.defineProperty,l=Object.defineProperties,a=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,i=(l,a,t)=>a in l?e(l,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[a]=t,u=(e,l)=>{for(var a in l||(l={}))o.call(l,a)&&i(e,a,l[a]);if(t)for(var a of t(l))s.call(l,a)&&i(e,a,l[a]);return e},n=(e,t)=>l(e,a(t));import{d as r,r as c,c as d,I as m,K as p,y as v,a7 as f,at as g,N as b,C as h,aD as y,aL as k,aP as _,b as w,g as C,w as V,h as S,l as x,aQ as j,z as K,i as O,L as z,E as I,j as $,t as F,q as P,G as T,a8 as B}from"./index-Bxqg77pZ.js";import{c as L,m as q,e as D,g as A,d as E,a as H,_ as R}from"./base64.C49xnrUQ.js";import{_ as W,h as G}from"./page-wraper.dVabujC3.js";import{f as M,w as N}from"./wd-picker-view.VnKySHsv.js";import{u as U}from"./useTranslate.CsR2puND.js";const Q=n(u({},L),{customLabelClass:q(""),customValueClass:q(""),customViewClass:q(""),label:String,placeholder:String,disabled:D(!1),readonly:D(!1),loading:D(!1),loadingColor:q("#4D80F0"),title:String,cancelButtonText:String,confirmButtonText:String,required:D(!1),size:String,labelWidth:q("33%"),useDefaultSlot:D(!1),useLabelSlot:D(!1),error:D(!1),alignRight:D(!1),beforeConfirm:Function,closeOnClickModal:D(!0),safeAreaInsetBottom:D(!0),ellipsis:D(!1),columnsHeight:E(217),valueKey:q("value"),labelKey:q("label"),modelValue:{type:[String,Number,Array],default:""},columns:{type:Array,default:()=>[]},columnChange:Function,displayFormat:Function,zIndex:E(15),prop:String,rules:A(),immediateChange:D(!1),rootPortal:D(!1),clearable:D(!1),markerSide:q("before")}),Z=R(r(n(u({},{name:"wd-picker",options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"}}),{props:Q,emits:["confirm","open","cancel","clear","update:modelValue"],setup(e,{expose:l,emit:a}){const{translate:t}=U("picker"),o=e,s=a,i=c(null),u=c(!1),n=c(!1),r=c(""),L=c(""),q=c([]),D=c([]),A=c(!1),E=c(!1),R=d((()=>o.loading||u.value));m((()=>o.displayFormat),(e=>{e&&!B(e)&&console.error("The type of displayFormat must be Function"),i.value&&0!==i.value.getSelectedIndex().length&&Y(o.modelValue)}),{immediate:!0,deep:!0}),m((()=>o.modelValue),(e=>{L.value=e,Y(e)}),{deep:!0,immediate:!0}),m((()=>o.columns),(e=>{q.value=g(e),D.value=g(e),0===e.length?(L.value=b(o.modelValue)?[]:"",r.value=""):Y(o.modelValue)}),{deep:!0,immediate:!0}),m((()=>o.columnChange),(e=>{e&&!B(e)&&console.error("The type of columnChange must be Function")}),{deep:!0,immediate:!0});const Q=d((()=>o.clearable&&!o.disabled&&!o.readonly&&r.value.length>0)),Z=d((()=>!o.disabled&&!o.readonly&&!Q.value)),J=d((()=>{const e=["wd-picker__cell"];return o.disabled&&e.push("is-disabled"),o.readonly&&e.push("is-readonly"),o.error&&e.push("is-error"),r.value||e.push("wd-picker__cell--placeholder"),e.join(" ")})),{proxy:X}=p();function Y(e){b(e)&&e.length>0||h(e)&&!b(e)&&""!==e?i.value?y((()=>{se(i.value.getSelects())})):se(function(e){const l=M(o.columns,o.valueKey,o.labelKey);if(0===o.columns.length)return;if(""===e||!h(e)||b(e)&&0===e.length)return;const a=k(e);if(-1===["string","number","boolean","array"].indexOf(a))return[];e=b(e)?e:[e],e=e.slice(0,l.length),0===e.length&&(e=l.map((()=>0)));let t=[];e.forEach(((e,a)=>{let s=l[a].findIndex((l=>l[o.valueKey].toString()===e.toString()));s=-1===s?0:s,t.push(s)}));const s=t.map(((e,a)=>l[a][e]));if(1===s.length)return s[0];return s}(e)):r.value=""}function ee(){o.disabled||o.readonly||(s("open"),n.value=!0,L.value=o.modelValue,q.value=D.value)}function le(){n.value=!1,s("cancel");let e=setTimeout((()=>{clearTimeout(e),h(i.value)&&i.value.resetColumns(D.value)}),300)}function ae(){if(R.value)return;if(A.value)return void(E.value=!0);const{beforeConfirm:e}=o;e&&B(e)?e(L.value,(e=>{e&&te()}),X.$.exposed):te()}function te(){if(R.value||o.disabled)return void(n.value=!1);const e=i.value.getSelects(),l=i.value.getValues(),a=i.value.getColumnsData();n.value=!1,D.value=g(a),s("update:modelValue",l),se(e),s("confirm",{value:l,selectedItems:e})}function oe({value:e}){L.value=e}function se(e){if(b(e)&&!e.length||!e)return;const{valueKey:l,labelKey:a}=o;r.value=(o.displayFormat||_)(e,{valueKey:l,labelKey:a})}function ie(){}function ue(){A.value=!0}function ne(){A.value=!1,E.value&&(E.value=!1,ae())}function re(){const e=b(L.value)?[]:"";s("update:modelValue",e),s("clear")}return v((()=>{Y(o.modelValue)})),f((()=>{q.value=g(o.columns),D.value=g(o.columns)})),l({close:function(){le()},open:function(){ee()},setLoading:function(e){u.value=e}}),(e,l)=>{const a=O;return C(),w(a,{class:P(`wd-picker ${e.disabled?"is-disabled":""} ${e.size?"is-"+e.size:""} ${e.alignRight?"is-align-right":""} ${e.error?"is-error":""} ${e.customClass}`),style:T(e.customStyle)},{default:V((()=>[e.$slots.default?(C(),w(a,{key:1,onClick:ee},{default:V((()=>[I(e.$slots,"default",{},void 0,!0)])),_:3})):(C(),w(W,{key:0,title:e.label,value:r.value?r.value:e.placeholder||x(t)("placeholder"),required:e.required,size:e.size,"title-width":e.labelWidth,prop:e.prop,rules:e.rules,clickable:!e.disabled&&!e.readonly,"value-align":e.alignRight?"right":"left","custom-class":J.value,"custom-style":e.customStyle,"custom-title-class":e.customLabelClass,"custom-value-class":e.customValueClass,ellipsis:e.ellipsis,"use-title-slot":!!e.$slots.label,"marker-side":e.markerSide,onClick:ee},j({"right-icon":V((()=>[Z.value?(C(),w(H,{key:0,"custom-class":"wd-picker__arrow",name:"arrow-right"})):Q.value?(C(),w(a,{key:1,onClick:z(re,["stop"])},{default:V((()=>[S(H,{"custom-class":"wd-picker__clear",name:"error-fill"})])),_:1})):K("",!0)])),_:2},[e.$slots.label?{name:"title",fn:V((()=>[I(e.$slots,"label",{},void 0,!0)])),key:"0"}:void 0]),1032,["title","value","required","size","title-width","prop","rules","clickable","value-align","custom-class","custom-style","custom-title-class","custom-value-class","ellipsis","use-title-slot","marker-side"])),S(G,{modelValue:n.value,"onUpdate:modelValue":l[1]||(l[1]=e=>n.value=e),position:"bottom","hide-when-close":!1,"close-on-click-modal":e.closeOnClickModal,"z-index":e.zIndex,"safe-area-inset-bottom":e.safeAreaInsetBottom,"root-portal":e.rootPortal,onClose:le,"custom-class":"wd-picker__popup"},{default:V((()=>[S(a,{class:"wd-picker__wraper"},{default:V((()=>[S(a,{class:"wd-picker__toolbar",onTouchmove:ie},{default:V((()=>[S(a,{class:"wd-picker__action wd-picker__action--cancel",onClick:le},{default:V((()=>[$(F(e.cancelButtonText||x(t)("cancel")),1)])),_:1}),e.title?(C(),w(a,{key:0,class:"wd-picker__title"},{default:V((()=>[$(F(e.title),1)])),_:1})):K("",!0),S(a,{class:P("wd-picker__action "+(R.value?"is-loading":"")),onClick:ae},{default:V((()=>[$(F(e.confirmButtonText||x(t)("done")),1)])),_:1},8,["class"])])),_:1}),S(N,{ref_key:"pickerViewWd",ref:i,"custom-class":e.customViewClass,modelValue:L.value,"onUpdate:modelValue":l[0]||(l[0]=e=>L.value=e),columns:q.value,loading:R.value,"loading-color":e.loadingColor,"columns-height":e.columnsHeight,"value-key":e.valueKey,"label-key":e.labelKey,"immediate-change":e.immediateChange,onChange:oe,onPickstart:ue,onPickend:ne,"column-change":e.columnChange},null,8,["custom-class","modelValue","columns","loading","loading-color","columns-height","value-key","label-key","immediate-change","column-change"])])),_:1})])),_:1},8,["modelValue","close-on-click-modal","z-index","safe-area-inset-bottom","root-portal"])])),_:3},8,["class","style"])}}})),[["__scopeId","data-v-8d8a6216"]]);export{Z as _};
